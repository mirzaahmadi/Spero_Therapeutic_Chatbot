import json
import ast

# === PASTE RAW STRING HERE ===
# The raw string represents a JSON array of therapy conversation data with roles (COUNSELEE, THERAPIST) and text.
# This raw string would typically be copied from a CSV or similar source.
raw = '''[{"role": "COUNSELEE", "text": "i'm feeling so distracted lately. my mind seems to be constantly busy, jumping from one thought to another. i can't seem to focus on anything for too long. it's becoming quite frustrating, and i don't know how to break free from this cycle."}, {"role": "THERAPIST", "text": "thank you for sharing that with me. it sounds like you're experiencing a lot of mental restlessness and difficulty concentrating. i'm curious, have you noticed any patterns or triggers that may be contributing to this distracted state you're in?"}, {"role": "COUNSELEE", "text": "well, now that you mention it, i've been spending a significant amount of time on my phone lately. i constantly find myself scrolling through social media feeds, watching videos, and playing games. it's become somewhat of an addiction, and i can't seem to put it down, even when i know i should be doing other things."}, {"role": "THERAPIST", "text": "i appreciate your honesty in recognizing that you may be facing an addiction to your phone. it takes strength to acknowledge these patterns and their potential impact on your mental well-being. addiction often offers a temporary escape from underlying emotions. have you noticed any feelings or emotions that you might be trying to avoid by getting lost in your phone?"}, {"role": "COUNSELEE", "text": "you're right, there are emotions i've been avoiding. lately, i've been feeling an overwhelming sense of sadness and emptiness. it's like a dark cloud follows me everywhere i go, and i just don't have the motivation or energy to engage with the world around me. using my phone has become a way to numb myself from these painful emotions."}, {"role": "THERAPIST", "text": "it takes courage to sit with these difficult emotions and acknowledge their presence. depression can often manifest as a deep sadness and a lack of motivation. i'm wondering, is there anything specific in your life right now that might be contributing to this heavy weight you're carrying?"}, {"role": "COUNSELEE", "text": "well, my job has been incredibly demanding lately, and the pressure to perform at a high level has been weighing on me. additionally, certain relationships in my life have become strained, leading to feelings of isolation and loneliness. i suppose all these factors combined have triggered this overwhelming sense of depression."}, {"role": "THERAPIST", "text": "it sounds like you're carrying a significant emotional load with both work and personal relationships. that can definitely contribute to feelings of depression and make it challenging to find joy in your day-to-day life. i'm curious, have you considered seeking support from a therapist or counselor who can help you navigate through these difficulties?"}, {"role": "COUNSELEE", "text": "i haven't considered that option before, but now that you mention it, it does seem like a logical step. i think having a safe space to open up about my struggles and receive guidance could be incredibly beneficial. maybe i've been trying to handle everything on my own for too long."}, {"role": "THERAPIST", "text": "seeking professional support can be an empowering choice, as it allows you to prioritize your mental health and well-being. therapy can provide you with tools and strategies to navigate through the challenges you're facing. are there any concerns or hesitations you have about starting therapy that we can address together?"}, {"role": "COUNSELEE", "text": "i suppose i have some reservations about opening up to someone new and being vulnerable. it's scary to think about sharing my deepest thoughts and emotions with someone i don't know. however, i also recognize that it's necessary for my healing process. i'm willing to take that leap of faith and give therapy a try."}, {"role": "THERAPIST", "text": "i applaud your willingness to embrace vulnerability and take that leap of faith. building a trusting therapeutic relationship takes time, and it's understandable to have reservations. remember, as your therapist, i'm here to provide a safe and non-judgmental space for you to explore your thoughts and emotions. together, we can work towards alleviating the weight of depression and finding a path towards healing and well-being."}, {"role": "COUNSELEE", "text": "thank you for your understanding and support. i truly believe that with therapy, i can begin to untangle the web of distractions, face my addiction, and ultimately find inner peace. i'm ready to start this journey towards a brighter and more fulfilling life."}, {"role": "THERAPIST", "text": "you're welcome, and i have no doubt that you have the strength and resilience to embark on this journey. remember to be kind to yourself throughout the process and celebrate each step forward, no matter how small. i'm honored to be alongside you as you navigate through this challenging terrain. together, we will work towards reclaiming your focus, overcoming addiction, and finding the light amidst the darkness."}]'''

# === CONVERT RAW STRING INTO JSON ===
# Convert the raw string into a Python object by parsing it using json.loads() 
# This will create a list of dictionaries, each containing 'role' and 'text' fields for therapy conversation
transcript = json.loads(raw)

# === FIX ESCAPED QUOTES ===
# Replace incorrectly escaped double quotes ("" instead of ") in the raw string for proper parsing
cleaned_str = raw.replace('""', '"')

# === SAFELY EVALUATE THE STRING TO A PYTHON OBJECT ===
# Use ast.literal_eval to safely convert the cleaned string into a Python object (list of dictionaries)
# This is done after replacing the quotes issue.
transcript = ast.literal_eval(cleaned_str)

# === SAVE DATA TO JSON FILE ===
# Write the processed transcript into a JSON file, formatted for readability with an indent of 2
with open("therapy_transcript.json", "w") as f:
    json.dump(transcript, f, indent=2)

# === CONFIRM SUCCESS ===
# Print a message confirming that the data has been saved successfully
print("âœ… Saved to therapy_transcript.json")
